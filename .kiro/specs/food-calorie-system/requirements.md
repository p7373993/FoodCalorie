# AI 기반 음식 칼로리 추정 및 소셜 챌린지 시스템 요구사항

## 소개

컴퓨터 비전과 AI를 활용하여 음식 사진에서 자동으로 칼로리를 추정하고, 사용자들이 함께 참여할 수 있는 소셜 챌린지 기능을 제공하는 다이어트 관리 시스템입니다.

## 요구사항

### 요구사항 1: AI 기반 음식 분석 시스템

**사용자 스토리:** 사용자로서 음식 사진을 업로드하면 자동으로 칼로리와 영양 정보를 분석받고 싶습니다.

#### 승인 기준
1. WHEN 사용자가 음식 사진을 업로드 THEN 시스템은 ML서버(8001포트)를 통해 음식 질량을 추정해야 합니다
2. WHEN 질량 추정이 완료 THEN 시스템은 음식 종류와 질량을 기반으로 칼로리를 계산해야 합니다
3. WHEN 칼로리 계산이 완료 THEN 시스템은 단백질, 탄수화물, 지방, 섬유질, 나트륨 등 영양소 정보를 제공해야 합니다
4. WHEN 분석이 완료 THEN 시스템은 신뢰도 점수(0-1)와 함께 결과를 반환해야 합니다
5. IF 분석 시간이 5초 이상 소요 THEN 시스템은 WebSocket을 통해 실시간 진행상황을 알려야 합니다

### 요구사항 2: 하이브리드 칼로리 추정 시스템

**사용자 스토리:** 사용자로서 정확하고 빠른 칼로리 추정 결과를 받고 싶습니다.

#### 승인 기준
1. WHEN 음식이 인식 THEN 시스템은 먼저 음식 DB에서 기본 칼로리 정보를 조회해야 합니다
2. WHEN 기본 칼로리가 계산 THEN 시스템은 LLM을 통해 조리법과 상태를 고려한 보정을 수행해야 합니다
3. WHEN 사용자가 실제 칼로리 피드백 제공 THEN 시스템은 해당 정보를 학습하여 개인화된 추정을 제공해야 합니다
4. WHEN 칼로리 추정 완료 THEN 시스템은 추정 방법(DB기반/LLM보정/개인화)을 명시해야 합니다

### 요구사항 3: 음식 등급 평가 시스템

**사용자 스토리:** 사용자로서 내가 먹은 음식의 영양학적 품질을 등급으로 확인하고 싶습니다.

#### 승인 기준
1. WHEN 영양소 분석이 완료 THEN 시스템은 좋은 영양소(단백질, 섬유질) - 나쁜 영양소(포화지방, 나트륨, 당분) 공식으로 점수를 계산해야 합니다
2. WHEN 영양 점수가 계산 THEN 시스템은 A(90-100), B(80-89), C(70-79), D(60-69), F(60미만) 등급을 부여해야 합니다
3. WHEN 등급이 결정 THEN 시스템은 등급 향상을 위한 구체적인 조언을 제공해야 합니다
4. WHEN 일일 식사가 완료 THEN 시스템은 하루 전체 영양 균형 점수를 계산해야 합니다

### 요구사항 4: 소셜 서바이벌 챌린지 시스템

**사용자 스토리:** 사용자로서 다른 사용자들과 함께 다이어트 챌린지에 참여하여 동기부여를 받고 싶습니다.

#### 승인 기준
1. WHEN 사용자가 /challenges 페이지 접속 THEN 시스템은 추천 챌린지와 참여 중인 챌린지를 카드 형태로 표시해야 합니다
2. WHEN 사용자가 '챌린지 만들기' 클릭 THEN 시스템은 챌린지 생성 폼(제목, 설명, 기간, 규칙, 최대 참여자)을 제공해야 합니다
3. WHEN 사용자가 챌린지 참여 THEN 시스템은 실시간으로 참여자 수를 업데이트해야 합니다
4. WHEN 챌린지 규칙 위반 THEN 시스템은 자동으로 해당 사용자를 탈락 처리해야 합니다
5. WHEN 사용자가 /challenges/[id] 접속 THEN 시스템은 SurvivalBoard를 통해 생존자/탈락자를 실시간으로 시각화해야 합니다

### 요구사항 5: 실시간 챌린지 모니터링

**사용자 스토리:** 사용자로서 챌린지 진행상황을 실시간으로 확인하고 싶습니다.

#### 승인 기준
1. WHEN 챌린지 상세 페이지 접속 THEN 시스템은 WebSocket 연결을 통해 실시간 업데이트를 제공해야 합니다
2. WHEN 참여자 상태 변경 THEN 시스템은 ParticipantCard의 스타일을 즉시 업데이트해야 합니다 (생존자: 일반, 탈락자: 회색조)
3. WHEN 새로운 참여자 가입 THEN 시스템은 모든 접속자에게 실시간으로 알림을 전송해야 합니다
4. WHEN 챌린지 종료 THEN 시스템은 최종 순위와 통계를 자동으로 생성해야 합니다

### 요구사항 6: 사용자 프로필 및 대시보드

**사용자 스토리:** 사용자로서 내 식사 기록과 진행상황을 한눈에 확인할 수 있는 대시보드를 원합니다.

#### 승인 기준
1. WHEN 사용자가 회원가입 THEN 시스템은 나이, 성별, 목표 체중, 활동량 정보를 수집해야 합니다
2. WHEN 사용자가 대시보드 접속 THEN 시스템은 월별 식사 기록을 InteractiveCalendar로 표시해야 합니다
3. WHEN 식사 기록이 있는 날짜 클릭 THEN 시스템은 해당 날의 상세 영양 분석을 표시해야 합니다
4. WHEN 대시보드 로드 THEN 시스템은 NutritionDonutChart를 통해 영양소 비율을 시각화해야 합니다
5. WHEN AI 코치 섹션 표시 THEN 시스템은 개인화된 다이어트 조언을 제공해야 합니다

### 요구사항 7: 인증 및 보안 시스템

**사용자 스토리:** 사용자로서 안전하고 편리한 로그인 방식을 원합니다.

#### 승인 기준
1. WHEN 사용자가 로그인 페이지 접속 THEN 시스템은 카카오 소셜 로그인과 이메일/비밀번호 로그인 옵션을 제공해야 합니다
2. WHEN 카카오 로그인 성공 THEN 시스템은 JWT 토큰을 생성하고 쿠키에 저장해야 합니다
3. WHEN 인증된 사용자가 API 요청 THEN 시스템은 토큰 유효성을 검증해야 합니다
4. WHEN 토큰 만료 THEN 시스템은 자동으로 로그인 페이지로 리다이렉트해야 합니다

### 요구사항 8: 시스템 통합 및 성능

**사용자 스토리:** 사용자로서 빠르고 안정적인 서비스를 이용하고 싶습니다.

#### 승인 기준
1. WHEN 프론트엔드에서 이미지 업로드 THEN 백엔드는 ML서버(8001포트)로 분석 요청을 전달해야 합니다
2. WHEN ML서버 응답 수신 THEN 백엔드는 결과를 데이터베이스에 저장하고 프론트엔드로 전달해야 합니다
3. WHEN 시스템 부하 증가 THEN Redis와 Celery를 통한 비동기 처리로 응답성을 유지해야 합니다
4. WHEN 이미지 분석 요청 THEN 시스템은 5초 이내에 첫 응답(진행상황 또는 결과)을 제공해야 합니다
5. WHEN 동시 사용자 100명 THEN 시스템은 정상적인 서비스를 제공해야 합니다